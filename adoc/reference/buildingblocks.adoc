== Building blocks

=== ARKANE API

The Arkane API is the core application of Arkane Network. It's a restful API, which consists of various endpoints to:

- View a user's wallets
- Request the balance or token balance of any Arkane Wallet
- Get the profile of a user
- Create signatures using an Arkane Wallet.


==== WHAT

==== Calling the Arkane API
To call an Arkane API, all you need is an endpoint and a valid authentication. 

WARNING: The Arkane API can also be used with API keys instead of Bearer Tokens. Using this authentication method is only encouraged in small scripts.

==== Result Wrapping

All of the API's responses are wrapped in an envelope. This envelope indicates whether the request succeeded. If the request failed, an additional `errors` object is added to the response.

*Example of a successful response*
[source,json]
----
{
  "success" : true,
  "result" : {
    "userId" : "davy",
    "hasMasterPin" : true
  }
}
----

*Example of a failed response*

[source,json]
----
{
    "success": false,
    "errors": [
        {
            "code": "pincode.no-tries-left",
            "message": "Max pincode tries exceeded"
        }
    ]
}
----

==== Authentication

Calling the Rest API requires authentication. At the moment, the following methods for authentication are available:

. Bearer Token
. API Key

===== Bearer Token

NOTE: A security token with the property that any party in possession of the token (a "bearer") can use the token in any way that any other party in possession of it can. Using a bearer token does not require a bearer to prove possession of cryptographic key material (proof-of-possession).

A Bearer Token is set in the Authorization header of every Inline Action HTTP Request. For example:

----
GET /api/wallets HTTP/1.1
Authorization: Bearer AbCdEf123456
Content-Type: application/json
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/1.0 (KHTML, like Gecko; Gmail Actions)
----

===== API Key

API Keys are also supported, in a limited fashion. An API key is generated through the Arkane Webapp and is always linked to a single wallet.

image::img/apikeys.png[Run]

An API key is set in the `authToken` header of every HTTP Request. For example:
----
GET /api/wallets HTTP/1.1
authToken: MW90eUtjTHwzMCVNbUVwcGU3LndLJCwwMDJKLTYtW2pzS0E4ck8yVDBCcSZZNjMjNjg=
Content-Type: application/json
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/1.0 (KHTML, like Gecko; Gmail Actions)
----

==== Limitations

Although the Arkane API supports creating signatures (it's even used as underlying building block of Arkane Connect), creating signatures is only possible when using *API Keys*. The main reason we block signature requests from being performed on other domains is because we don't want the user to enter his *private pin* on an untrusted domain. 

TIP: If you want to create signatures on your own domain, use *Arkane Connect*.

=== ARKANE CONNECT

==== WHAT

Arkane Connect is an endpoint specifically designed to perform common tasks with Arkane wallets. Connect was created as a way to perform tasks which are

. otherwise not possible due to security reasons, *like creating signatures*
. necessary by all applications, like linking wallets your client

Basically, Arkane Connect is a small web application without a central entry point. Calls to Arkane Connect are made by navigating to a specific url. Although you can use it by itself - by manually crafting the urls - we also provide a javascript SDK.  

==== HOW    

Arkane connect can be called by navigating to a specifically crafted URI. 

There are 2 ways of calling Arkane Connect, the *GET* or *POST* method. For security reasons, we advise to use the *POST* method, as this doesn't leak the short-lived bearer tokens as GET-parameters.

NOTE: Although Arkane Connect can be called natively, we advise you to use the Arkane Connect JS Library.

===== GET Method

. Example call

`GET`

`https://connect.arkane.network/wallets/manage/vechain?bearerToken=myToken&redirectUrl=https://fundrequest.io`

|=== 
| *url* | The actual url of the action we want to do. This consists of the base url (https://connect.arkane.network) and the endpoint (`wallets/manage/vechain`)
|=== 


*Query Parameters*
|=== 
| *bearerToken* | the security token which performs the authentication.
| *redirectUrl* | the url to redirect to after the action has been performed. If the redirectUrl was not passed, the referer will be used instead.
| *data* | an optional data parameter, which will be used by the specific call. (Example: data to be signed). This should always be *encoded as base64*.
|===

NOTE: Make sure all query parameters are url encoded (ex. https://www.urlencoder.org/)


===== POST Method (recommended)

. Example call

`POST`

`https://connect.arkane.network/wallets/manage/vechain`

*Query Parameters*

|=== 
| *redirectUrl* | the url to redirect to after the action has been performed. If the redirectUrl was not passed, the referer will be used instead.
| *correlationID* | an optional identifier which can be added. Upon navigating back to your *redirectUrl*, after an action was performed, this *correlationID* will be appended to your URL, so the origin can be tracked.  
|=== 

. Post Parameters
|=== 
| *bearerToken* | the security token which performs the authentication. Note: it is also possible to provide this parameter inside the HTTP header “Authorization”
| *data* | an optional data parameter, which will be used by the specific call. (Example: data to be signed). When using the *Post Method*, don't encode as base64.
|===


=== ARKANE IDENTITY

Our third and final building block is Arkane Identity.
Arkane Identity's sole purpose is to provide a way to authenticate to the Arkane Network using OAuth2.

link:authentication[Authentication]